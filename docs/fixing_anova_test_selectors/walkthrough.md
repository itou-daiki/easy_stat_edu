# 修正内容の確認 (Walkthrough): Fixing ANOVA Test Selectors

## タスクの目的
旧式の独自マルチセレクトUI廃止と、新しいネイティブ`select`タグベースへの実装移行に伴い発生していた、各種Playwrightテスト（二要因分散分析および分析おすすめ機能等）のエラー修正を行いました。

## 修正詳細
1. **分析サポート機能（`analysis_support.spec.ts`）のテスト修正**
   * テキストマイニングが提案されない要因となっていたダミーデータのレコード数不足（カテゴリカル変数と誤認される問題）を解決するため、CSV生成時のデータ行数を15行へ増加させました。

2. **二要因分散分析（反復測定）のテスト修正（`anova_two_way_within.spec.ts`）**
   * IDの不一致によるハングアップを解決するため、古い `#within-controls` 等のセレクタを、現在の実装である `#repeated-controls`, `#rm-f1-name`, `#rm-generate-grid-btn` 等に書き換えました。

3. **二要因分散分析（混合計画）のテスト修正（`anova_two_way_mixed_multipair.spec.ts`）**
   * 変数ペア指定機能において、`MultiSelect`ではなくネイティブな`select`タグを使用する構造に合致するようロジックを修正。
   * ラベル指定の不一致（デモデータの `Pre_Score` が `リーディング力（前）` 等でロードされる仕様）を解消し、正確なオプションラベルを指定することでタイムアウトエラーを解消しました。
   * テスト通過の障壁となっていた、出力結果テーブルの見出しテキストの検証アサーションにおいて、期待される見出しテキストを `混合計画分散分析の結果` から新仕様の `混合要因分散分析表` に修正。あわせて出力ロジックで欠落していた `designType: 'mixed'` プロパティを補完し、意図した見出しが出力されるよう調整しました。
   * ANOVAカードの要件緩和（`index.html`）：混合計画や反復測定で2つのカテゴリカル変数が必須となるUI上の制限（`data-requires="numeric:1,categorical:2"`）がテストクリックを妨げていたため、これを `data-requires="numeric:1"` に緩和し、無事画面遷移が行えるようにしました。

4. **因子分析関連のセレクタ追従**
   * `factor_analysis.spec.ts`, `factor_analysis_rotation.spec.ts` などにおいて、古いチェックボックスベースの操作から、データ属性 `data-value` を使った直接クリックによる項目選択指定へ変更を行いました。

## 検証結果
* 関連する全てのEnd-to-Endテスト（Playwright）をシリアル実行し、`16 passed` （エラーゼロ）となることを確認しました。
* アプリケーションがハングアップしたり要素が見つからずにタイムアウトする不具合は全て解消されています。

## 今後の推奨事項
* テストで利用する変数の日本語ラベルは、データセット（`2way_anova_demo_mix.xlsx`）の列名に依存している点に留意してください。列名が変更された場合は、テスト側のラベル指定も同様にアップデートする必要があります。
